# Shared jobs specific to the OpenLab Project

- job:
    name: base
    parent: null
    description: |
      A subset of what the 'base' job provides: the absolute minimum considered
      required to run for any one job.
      It doesn't set up cached git repositories, will not set up mirrors,
      doesn't validate the node and does not generate an ARA report.
      These tasks, if required, can be included by the dependant jobs
      themselves on a need basis.
    attempts: 2
    pre-run: playbooks/base/pre.yaml
    post-run:
      - playbooks/base/post-ssh.yaml
      - playbooks/base/post-logs.yaml
    roles:
      - zuul: theopenlab/zuul-jobs
      - zuul: theopenlab/project-config
    timeout: 1800
    nodeset: ubuntu-xenial
    secrets:
      - site_logs

# Common test base job
- job:
    name: init-test
    description: |
      Base job for all types of test jobs. Ensure workspace and copy log files.
    pre-run: playbooks/init-test/pre.yaml
    post-run: playbooks/init-test/post.yaml
    timeout: 10800
    vars:
      global_env:
        OS_BRANCH: master
        # LOGS/RESULTS_PATH is created in roles.prepare_workspace, we enable
        # these two vars in here for cross playbook usage.
        LOGS_PATH: '{{ ansible_user_dir }}/workspace/logs'
        RESULTS_PATH: '{{ ansible_user_dir }}/workspace/test_results'

- job:
    name: init-test-main
    description: |
      Base job for all types of test jobs(main branch). Ensure workspace and copy log files.
    pre-run: playbooks/init-test/pre.yaml
    post-run: playbooks/init-test/post.yaml
    timeout: 10800
    vars:
      global_env:
        OS_BRANCH: main
        # LOGS/RESULTS_PATH is created in roles.prepare_workspace, we enable
        # these two vars in here for cross playbook usage.
        LOGS_PATH: '{{ ansible_user_dir }}/workspace/logs'
        RESULTS_PATH: '{{ ansible_user_dir }}/workspace/test_results'

# Golang test base job
- job:
    name: golang-test
    parent: init-test
    description: |
      Base job for all types of golang test jobs.
    post-run: playbooks/golang-test/post.yaml

- job:
    name: golang-test-main
    parent: init-test-main
    description: |
      Base job for all types of golang test jobs(main branch).
    post-run: playbooks/golang-test/post.yaml

# Terraform-provider-openstack jobs
- job:
    name: terraform-provider-openstack-unittest
    parent: golang-test-main
    description: |
      Run terraform-provider-openstack unit test
    run: playbooks/terraform-provider-openstack-unittest/run.yaml
    nodeset: ubuntu-xenial-ut
    vars:
      go_version: '1.14'

## ========== terraform-provider-openstack + openstack jobs ==============

### parent job
- job:
    name: terraform-provider-openstack-acceptance-test
    parent: golang-test-main
    description: |
      Run terraform-provider-openstack acceptance test against master OpenStack
    run: playbooks/terraform-provider-openstack-acceptance-test/run.yaml
    nodeset: ubuntu-bionic
    timeout: 21600
    vars:
      go_version: '1.14'

### job that runs with admin creds
- job:
    name: terraform-provider-openstack-acceptance-test-admin
    parent: golang-test-main
    description: |
      Run terraform-provider-openstack acceptance test against master OpenStack with admin creds
    run: playbooks/terraform-provider-openstack-acceptance-test-admin/run.yaml
    nodeset: ubuntu-bionic
    timeout: 21600
    vars:
      go_version: '1.14'

### son job against stein branch of OpenStack
- job:
    name: terraform-provider-openstack-acceptance-test-stein
    parent: terraform-provider-openstack-acceptance-test
    description: |
      Run terraform-provider-openstack acceptance test against stein branch of OpenStack
    vars:
      global_env:
        OS_BRANCH: stable/stein
### grandson job pinned v1.19.0 against stein branch of OpenStack
- job:
    name: terraform-provider-openstack-v1.19.0-acceptance-test-stein
    parent: terraform-provider-openstack-acceptance-test-stein
    description: |
      Run terraform-provider-openstack of v1.19.0 acceptance test against stein branch of OpenStack
    override-checkout: v1.19.0
    tags:
      - Category:Cloud
      - Project:terraform-provider-openstack/terraform-provider-openstack
      - Application:terraform-provider-openstack@v1.19.0
      - Application:OpenStack@stein
      - Application:Go@1.12.1
      - Arch:x86_64
      - OS:ubuntu-xenial
      - BuildType:Integration test

### son job against rocky branch of OpenStack
- job:
    name: terraform-provider-openstack-acceptance-test-rocky
    parent: terraform-provider-openstack-acceptance-test
    description: |
      Run terraform-provider-openstack acceptance test against rocky branch of OpenStack
    vars:
      global_env:
        OS_BRANCH: stable/rocky
### grandson job pinned v1.19.0 against rocky branch of OpenStack
- job:
    name: terraform-provider-openstack-v1.19.0-acceptance-test-rocky
    parent: terraform-provider-openstack-acceptance-test-rocky
    description: |
      Run terraform-provider-openstack of v1.19.0 acceptance test against rocky branch of OpenStack
    override-checkout: v1.19.0
    tags:
      - Category:Cloud
      - Project:terraform-provider-openstack/terraform-provider-openstack
      - Application:terraform-provider-openstack@v1.19.0
      - Application:OpenStack@rocky
      - Application:Go@1.12.1
      - Arch:x86_64
      - OS:ubuntu-xenial
      - BuildType:Integration test

### son job against queens branch of OpenStack
- job:
    name: terraform-provider-openstack-acceptance-test-queens
    parent: terraform-provider-openstack-acceptance-test
    description: |
      Run terraform-provider-openstack acceptance test against queens branch of OpenStack
    vars:
      global_env:
        OS_BRANCH: stable/queens
### grandson job pinned v1.19.0 against queens branch of OpenStack
- job:
    name: terraform-provider-openstack-v1.19.0-acceptance-test-queens
    parent: terraform-provider-openstack-acceptance-test-queens
    description: |
      Run terraform-provider-openstack of v1.19.0 acceptance test against queens branch of OpenStack
    override-checkout: v1.19.0
    tags:
      - Category:Cloud
      - Project:terraform-provider-openstack/terraform-provider-openstack
      - Application:terraform-provider-openstack@v1.19.0
      - Application:OpenStack@queens
      - Application:Go@1.12.1
      - Arch:x86_64
      - OS:ubuntu-xenial
      - BuildType:Integration test

### son job against pike branch of OpenStack
- job:
    name: terraform-provider-openstack-acceptance-test-pike
    parent: terraform-provider-openstack-acceptance-test
    description: |
      Run terraform-provider-openstack acceptance test against pike branch of OpenStack
    vars:
      global_env:
        OS_BRANCH: stable/pike
### grandson job pinned v1.19.0 against pike branch of OpenStack
- job:
    name: terraform-provider-openstack-v1.19.0-acceptance-test-pike
    parent: terraform-provider-openstack-acceptance-test-pike
    description: |
      Run terraform-provider-openstack of v1.19.0 acceptance test against pike branch of OpenStack
    override-checkout: v1.19.0
    tags:
      - Category:Cloud
      - Project:terraform-provider-openstack/terraform-provider-openstack
      - Application:terraform-provider-openstack@v1.19.0
      - Application:OpenStack@pike
      - Application:Go@1.12.1
      - Arch:x86_64
      - OS:ubuntu-xenial
      - BuildType:Integration test

### son job against ocata branch of OpenStack
- job:
    name: terraform-provider-openstack-acceptance-test-ocata
    parent: terraform-provider-openstack-acceptance-test
    description: |
      Run terraform-provider-openstack acceptance test against ocata branch of OpenStack
    vars:
      global_env:
        OS_BRANCH: stable/ocata
### grandson job pinned v1.19.0 against ocata branch of OpenStack
- job:
    name: terraform-provider-openstack-v1.19.0-acceptance-test-ocata
    parent: terraform-provider-openstack-acceptance-test-ocata
    description: |
      Run terraform-provider-openstack of v1.19.0 acceptance test against ocata branch of OpenStack
    override-checkout: v1.19.0
    tags:
      - Category:Cloud
      - Project:terraform-provider-openstack/terraform-provider-openstack
      - Application:terraform-provider-openstack@v1.19.0
      - Application:OpenStack@ocata
      - Application:Go@1.12.1
      - Arch:x86_64
      - OS:ubuntu-xenial
      - BuildType:Integration test

### son job against newton branch of OpenStack
- job:
    name: terraform-provider-openstack-acceptance-test-newton
    parent: terraform-provider-openstack-acceptance-test
    description: |
      Run terraform-provider-openstack acceptance test against newton branch of OpenStack
    vars:
      global_env:
        OS_BRANCH: stable/newton
### grandson job pinned v1.19.0 against newton branch of OpenStack
- job:
    name: terraform-provider-openstack-v1.19.0-acceptance-test-newton
    parent: terraform-provider-openstack-acceptance-test-newton
    description: |
      Run terraform-provider-openstack of v1.19.0 acceptance test against newton branch of OpenStack
    override-checkout: v1.19.0
    tags:
      - Category:Cloud
      - Project:terraform-provider-openstack/terraform-provider-openstack
      - Application:terraform-provider-openstack@v1.19.0
      - Application:OpenStack@newton
      - Application:Go@1.12.1
      - Arch:x86_64
      - OS:ubuntu-xenial
      - BuildType:Integration test

### son job against mitaka branch of OpenStack
#- job:
#    name: terraform-provider-openstack-acceptance-test-mitaka
#    parent: terraform-provider-openstack-acceptance-test
#    description: |
#      Run terraform-provider-openstack acceptance test against mitaka branch of OpenStack
#    vars:
#      global_env:
#        OS_BRANCH: stable/mitaka
#    nodeset: ubuntu-trusty
### grandson job pinned v1.19.0 against mitaka branch of OpenStack
#- job:
#    name: terraform-provider-openstack-v1.19.0-acceptance-test-mitaka
#    parent: terraform-provider-openstack-acceptance-test-mitaka
#    description: |
#      Run terraform-provider-openstack of v1.19.0 acceptance test against mitaka branch of OpenStack
#    override-checkout: v1.19.0
#    tags:
#      - Category:Cloud
#      - Project:terraform-provider-openstack/terraform-provider-openstack
#      - Application:terraform-provider-openstack@v1.19.0
#      - Application:OpenStack@mitaka
#      - Application:Go@1.12.1
#      - Arch:x86_64
#      - OS:ubuntu-xenial
#      - BuildType:Integration test

- job:
    name: terraform-provider-openstack-acceptance-test-designate
    parent: golang-test-main
    description: |
      Run terraform-provider-openstack designate acceptance test on master branch
    run: playbooks/terraform-provider-openstack-acceptance-test-designate/run.yaml
    nodeset: ubuntu-bionic
    vars:
      go_version: '1.14'

- job:
    name: terraform-provider-openstack-acceptance-test-trove
    parent: golang-test-main
    description: |
      Run terraform-provider-openstack trove acceptance test on master branch
    run: playbooks/terraform-provider-openstack-acceptance-test-trove/run.yaml
    nodeset: ubuntu-bionic
    vars:
      go_version: '1.14'

- job:
    name: terraform-provider-openstack-acceptance-test-lbaas
    parent: golang-test-main
    description: |
      Run terraform-provider-openstack lbaas acceptance test on master branch
    run: playbooks/terraform-provider-openstack-acceptance-test-lbaas/run.yaml
    timeout: 25200 # 7h
    nodeset: ubuntu-bionic
    vars:
      go_version: '1.14'

- job:
    name: terraform-provider-openstack-acceptance-test-fwaas
    parent: golang-test-main
    description: |
      Run terraform-provider-openstack fwaas acceptance test on master branch
    run: playbooks/terraform-provider-openstack-acceptance-test-fwaas/run.yaml
    nodeset: ubuntu-bionic
    vars:
      go_version: '1.14'

# terraform-provider-openstack acceptance tests with Telefonica cloud
- job:
    name: terraform-provider-openstack-acceptance-test-telefonica
    parent: golang-test-main
    description: |
      Run acceptance tests of terraform-provider-openstack repo against telefonica cloud
    run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/run.yaml
    post-run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/post.yaml
    secrets:
      - telefonica_credentials
    vars:
      go_version: '1.14'
      cloud_name: telefonica

# terraform-provider-openstack acceptance tests with Open Telekom cloud
- job:
    name: terraform-provider-openstack-acceptance-test-opentelekomcloud
    parent: golang-test-main
    description: |
      Run acceptance tests of terraform-provider-openstack repo against opentelekomcloud
    run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/run.yaml
    post-run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/post.yaml
    secrets:
      - opentelekomcloud_credentials
    vars:
      go_version: '1.14'
      cloud_name: opentelekomcloud

# terraform-provider-openstack acceptance tests with orange cloud
- job:
    name: terraform-provider-openstack-acceptance-test-orange
    parent: golang-test-main
    description: |
      Run acceptance tests of terraform-provider-openstack repo against orange cloud
    run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/run.yaml
    post-run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/post.yaml
    secrets:
      - orange_credentials
    vars:
      go_version: '1.14'
      cloud_name: orange

# Gophercloud acceptance tests with Telefonica cloud, now the job is disabled
- job:
    name: gophercloud-acceptance-test-telefonica
    parent: golang-test
    description: |
      Run gophercloud acceptance test against telefonica cloud
    run: playbooks/gophercloud-acceptance-test-telefonica/run.yaml
    secrets:
      - telefonica_credentials

# ========== gophercloud + openstack jobs ==============
# grandson job for stein
- job:
    name: gophercloud-v0.4.0-acceptance-test-stein
    parent: gophercloud-acceptance-test-stein
    description: |
      Run gophercloud v0.4.0 acceptance test on stein branch of OpenStack
    override-checkout: v0.4.0
    tags:
      - Category:Cloud
      - Project:gophercloud/gophercloud
      - Application:gophercloud@v0.4.0
      - Application:OpenStack@stein
      - Application:Go@1.12.1
      - Arch:x86_64
      - OS:ubuntu-xenial
      - BuildType:Integration test

## grandson job for rocky
- job:
    name: gophercloud-v0.4.0-acceptance-test-rocky
    parent: gophercloud-acceptance-test-rocky
    description: |
      Run gophercloud v0.4.0 acceptance test on rocky branch of OpenStack
    override-checkout: v0.4.0
    tags:
      - Category:Cloud
      - Project:gophercloud/gophercloud
      - Application:gophercloud@v0.4.0
      - Application:OpenStack@rocky
      - Application:Go@1.12.1
      - Arch:x86_64
      - OS:ubuntu-xenial
      - BuildType:Integration test

## grandson job for queens
- job:
    name: gophercloud-v0.4.0-acceptance-test-queens
    parent: gophercloud-acceptance-test-queens
    description: |
      Run gophercloud v0.4.0 acceptance test on queens branch of OpenStack
    override-checkout: v0.4.0
    tags:
      - Category:Cloud
      - Project:gophercloud/gophercloud
      - Application:gophercloud@v0.4.0
      - Application:OpenStack@queens
      - Application:Go@1.12.1
      - Arch:x86_64
      - OS:ubuntu-xenial
      - BuildType:Integration test

## grandson job for pike
- job:
    name: gophercloud-v0.4.0-acceptance-test-pike
    parent: gophercloud-acceptance-test-pike
    description: |
      Run gophercloud v0.4.0 acceptance test on pike branch of OpenStack
    override-checkout: v0.4.0
    tags:
      - Category:Cloud
      - Project:gophercloud/gophercloud
      - Application:gophercloud@v0.4.0
      - Application:OpenStack@pike
      - Application:Go@1.12.1
      - Arch:x86_64
      - OS:ubuntu-xenial
      - BuildType:Integration test

## grandson job for ocata
- job:
    name: gophercloud-v0.4.0-acceptance-test-ocata
    parent: gophercloud-acceptance-test-ocata
    description: |
      Run gophercloud v0.4.0 acceptance test on ocata branch of OpenStack
    override-checkout: v0.4.0
    tags:
      - Category:Cloud
      - Project:gophercloud/gophercloud
      - Application:gophercloud@v0.4.0
      - Application:OpenStack@ocata
      - Application:Go@1.12.1
      - Arch:x86_64
      - OS:ubuntu-xenial
      - BuildType:Integration test

## grandson job for newton
- job:
    name: gophercloud-v0.4.0-acceptance-test-newton
    parent: gophercloud-acceptance-test-newton
    description: |
      Run gophercloud v0.4.0 acceptance test on newton branch of OpenStack
    override-checkout: v0.4.0
    tags:
      - Category:Cloud
      - Project:gophercloud/gophercloud
      - Application:gophercloud@v0.4.0
      - Application:OpenStack@newton
      - Application:Go@1.12.1
      - Arch:x86_64
      - OS:ubuntu-xenial
      - BuildType:Integration test

# terraform-provider-telefonicaopencloud acceptance tests with Telefonica cloud
# the job is disabled now
- job:
    name: terraform-provider-telefonicaopencloud-acceptance-test-telefonica
    parent: golang-test-main
    description: |
      Run acceptance tests of terraform-provider-telefonicaopencloud repo against telefonica cloud
    run: playbooks/terraform-provider-telefonicaopencloud-acceptance-test-telefonica/run.yaml
    secrets:
      - telefonica_credentials

# terraform-provider-flexibleengine acceptance tests with orange cloud
# the job is disabled now
- job:
    name: terraform-provider-flexibleengine-acceptance-test-orange
    parent: golang-test-main
    description: |
      Run acceptance tests of terraform-provider-flexibleengine repo against orange cloud
    run: playbooks/terraform-provider-flexibleengine-acceptance-test-orange/run.yaml
    secrets:
      - orange_credentials

# terraform-provider-opentelekomcloud acceptance tests with Open Telekom cloud
# the job is disabled now
- job:
    name: terraform-provider-opentelekomcloud-acceptance-test-opentelekomcloud
    parent: golang-test-main
    description: |
      Run acceptance tests of terraform-provider-opentelekomcloud repo against open telekom cloud
    run: playbooks/terraform-provider-opentelekomcloud-acceptance-test-opentelekomcloud/run.yaml
    secrets:
      - opentelekomcloud_credentials

# OpenLab job self-check jobs
- job:
    name: openlab-zuul-jobs-check
    parent: init-test
    description: |
      This job runs against project-config, openlab-zuul-jobs and zuul-jobs
      so we can properly lint our ansible playbooks / roles
    required-projects:
      - theopenlab/openlab-zuul-jobs
      - theopenlab/project-config
      - theopenlab/zuul-jobs
    run: playbooks/openlab-zuul-jobs-check/run.yaml
    vars:
      excluded_path: "playbooks/base/*"
    nodeset: ubuntu-xenial-ut

# Kubernetes cloud-provider-openstack jobs
- job:
    name: cloud-provider-openstack-test
    parent: golang-test
    description: |
      Base job for all types of cloud-provider-openstack test jobs
    pre-run: playbooks/cloud-provider-openstack-test/pre.yaml
    post-run: playbooks/cloud-provider-openstack-test/post.yaml
    secrets:
      - citynetwork_credentials
      - gcp_account_cpo
      - swr
    vars:
      k8s_os_provider_src_dir: '{{ ansible_user_dir }}/src/k8s.io/cloud-provider-openstack'
      k8s_src_dir: '{{ ansible_user_dir }}/src/k8s.io/kubernetes'
      k8s_log_dir: '{{ ansible_user_dir }}/workspace/logs/kubernetes'
      kubectl: '{{ ansible_user_dir }}/src/k8s.io/kubernetes/cluster/kubectl.sh'
      cloud_name: citynetwork
      go_version: '1.16'

- job:
    name: cloud-provider-openstack-unittest
    parent: cloud-provider-openstack-test
    description: |
      Run unit test of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-unittest/run.yaml
    nodeset: ubuntu-xenial-citynetwork
    secrets:
      - citynetwork_credentials

- job:
    name: cloud-provider-openstack-format
    parent: cloud-provider-openstack-test
    description: |
      Run gofmt and typo checking of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-format/run.yaml
    nodeset: ubuntu-xenial-ut

- job:
    name: cloud-provider-openstack-sanity-test-csi-cinder
    parent: cloud-provider-openstack-test
    description: |
      Run csi sanity tests cloud-provider-openstack cinder-csi-plugin
    run: playbooks/cloud-provider-openstack-sanity-test-csi-cinder/run.yaml
    nodeset: ubuntu-xenial-citynetwork
    secrets:
      - citynetwork_credentials

- job:
    name: cloud-provider-openstack-acceptance-test-k8s-cinder
    parent: cloud-provider-openstack-test
    description: |
      Run cinder in-tree acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-k8s-cinder/run.yaml
    post-run: playbooks/cloud-provider-openstack-acceptance-test-k8s-cinder/post.yaml
    nodeset: ubuntu-xenial-citynetwork
    secrets:
      - citynetwork_credentials
      - swr

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-legacy
    parent: cloud-provider-openstack-test
    description: |
      Run Kubernetes E2E Conformance tests against a multinode Kubernetes cluster created by kubeadm
    run: playbooks/cloud-provider-openstack-acceptance-test-e2e-conformance/run.yaml
    post-run: playbooks/cloud-provider-openstack-acceptance-test-e2e-conformance/post.yaml
    nodeset: ubuntu-xenial-k8s-cluster-cpo
    secrets:
      - citynetwork_credentials
      - gcp_account_cpo
      - swr

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance
    parent: cloud-provider-openstack-test
    description: |
      Run Kubernetes E2E Conformance tests against a multinode k3s cluster
    run: playbooks/cloud-provider-openstack-test-occm-e2e-conformance/run.yaml
    post-run: playbooks/cloud-provider-openstack-test-occm-e2e-conformance/post.yaml
    nodeset: ubuntu-focal-large
    vars:
      cpo_src_dir: '{{ ansible_user_dir }}/src/k8s.io/cloud-provider-openstack'
    secrets:
      - gcp_account_cpo
      - swr

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-stable-branch-v1.10
    parent: cloud-provider-openstack-acceptance-test-e2e-conformance
    description: |
      Run Kubernetes E2E Conformance tests against Kubernetes v1.10
    vars:
      go_version: '1.9.3'
      k8s_version: 'release-1.10'

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-stable-branch-v1.11
    parent: cloud-provider-openstack-acceptance-test-e2e-conformance
    description: |
      Run Kubernetes E2E Conformance tests against Kubernetes v1.11
    vars:
      go_version: '1.10.3'
      k8s_version: 'release-1.11'

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-stable-branch-v1.12
    parent: cloud-provider-openstack-acceptance-test-e2e-conformance
    description: |
      Run Kubernetes E2E Conformance tests against release-1.12 branch of Kubernetes
    vars:
      go_version: '1.10.8'
      k8s_version: 'release-1.12'
    tags:
      - Category:Cloud
      - Project:kubernetes/cloud-provider-openstack
      - Application:cloud-provider-openstack@release-1.12
      - Application:Kubernetes@release-1.12
      - Application:Docker.io@v18.09
      - Application:Etcd@v3.3.10
      - Application:Go@1.10.8
      - OS:ubuntu-xenial
      - Arch:x86_64
      - BuildType:Integration test

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-stable-branch-v1.13
    parent: cloud-provider-openstack-acceptance-test-e2e-conformance
    description: |
      Run Kubernetes E2E Conformance tests against release-1.13 branch of Kubernetes
    nodeset: ubuntu-xenial-citynetwork
    vars:
      go_version: '1.12'
      k8s_version: 'release-1.13'
      etcd_version: 'v3.3.10'
    tags:
      - Category:Cloud
      - Project:kubernetes/cloud-provider-openstack
      - Application:cloud-provider-openstack@release-1.13
      - Application:Kubernetes@release-1.13
      - Application:Docker.io@v18.09
      - Application:Etcd@v3.3.10
      - Application:Go@1.12
      - OS:ubuntu-xenial
      - Arch:x86_64
      - BuildType:Integration test

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-stable-branch-v1.14
    parent: cloud-provider-openstack-acceptance-test-e2e-conformance
    description: |
      Run Kubernetes E2E Conformance tests against release-1.14 branch of Kubernetes
    nodeset: ubuntu-xenial-citynetwork
    vars:
      go_version: '1.12.1'
      k8s_version: 'release-1.14'
      etcd_version: 'v3.3.10'
    tags:
      - Category:Cloud
      - Project:kubernetes/cloud-provider-openstack
      - Application:cloud-provider-openstack@release-1.14
      - Application:Kubernetes@release-1.14
      - Application:Docker.io@v18.09
      - Application:Etcd@v3.3.10
      - Application:Go@1.12.1
      - OS:ubuntu-xenial
      - Arch:x86_64
      - BuildType:Integration test

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-stable-branch-v1.15
    parent: cloud-provider-openstack-acceptance-test-e2e-conformance
    description: |
      Run Kubernetes E2E Conformance tests against release-1.15 branch of Kubernetes
    nodeset: ubuntu-xenial-citynetwork
    vars:
      go_version: '1.12.1'
      k8s_version: 'release-1.15'
      etcd_version: 'v3.3.10'
    tags:
      - Category:Cloud
      - Project:kubernetes/cloud-provider-openstack
      - Application:cloud-provider-openstack@release-1.15
      - Application:Kubernetes@release-1.15
      - Application:Docker.io@v18.09
      - Application:Etcd@v3.3.10
      - Application:Go@1.12.1
      - OS:ubuntu-xenial
      - Arch:x86_64
      - BuildType:Integration test

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-stable-branch-v1.16
    parent: cloud-provider-openstack-acceptance-test-e2e-conformance
    description: |
      Run Kubernetes E2E Conformance tests against release-1.16 branch of Kubernetes
    nodeset: ubuntu-xenial-k8s-cluster-cpo
    vars:
      go_version: '1.13.5'
      k8s_version: 'release-1.16'
      etcd_version: 'v3.3.15'
      kubernetes_version: 'v1.16.13'
    tags:
      - Category:Cloud
      - Project:kubernetes/cloud-provider-openstack
      - Application:cloud-provider-openstack@release-1.16
      - Application:Kubernetes@release-1.16
      - Application:Docker.io@v18.09
      - Application:Etcd@v3.3.15
      - Application:Go@1.13.5
      - OS:ubuntu-xenial
      - Arch:x86_64
      - BuildType:Integration test

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-stable-branch-v1.17
    parent: cloud-provider-openstack-acceptance-test-e2e-conformance
    description: |
      Run Kubernetes E2E Conformance tests against release-1.17 branch of Kubernetes
    nodeset: ubuntu-xenial-k8s-cluster-cpo
    vars:
      go_version: '1.13.4'
      k8s_version: 'release-1.17'
      etcd_version: 'v3.4.3'
      kubernetes_version: 'v1.17.9'
    tags:
      - Category:Cloud
      - Project:kubernetes/cloud-provider-openstack
      - Application:cloud-provider-openstack@release-1.17
      - Application:Kubernetes@release-1.17
      - Application:Docker.io@v18.09
      - Application:Etcd@v3.4.3
      - Application:Go@1.13.4
      - OS:ubuntu-xenial
      - Arch:x86_64
      - BuildType:Integration test

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-stable-branch-v1.18
    parent: cloud-provider-openstack-acceptance-test-e2e-conformance
    description: |
      Run Kubernetes E2E Conformance tests against release-1.18 branch of Kubernetes
    nodeset: ubuntu-xenial-k8s-cluster-cpo
    vars:
      go_version: '1.13.4'
      k8s_version: 'release-1.18'
      etcd_version: 'v3.4.3'
      kubernetes_version: 'v1.18.6'
    tags:
      - Category:Cloud
      - Project:kubernetes/cloud-provider-openstack
      - Application:cloud-provider-openstack@release-1.18
      - Application:Kubernetes@release-1.18
      - Application:Docker.io@v18.09
      - Application:Etcd@v3.4.3
      - Application:Go@1.13.4
      - OS:ubuntu-xenial
      - Arch:x86_64
      - BuildType:Integration test

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-stable-branch-v1.19
    parent: cloud-provider-openstack-acceptance-test-e2e-conformance-legacy
    description: |
      Run Kubernetes E2E Conformance tests against release-1.19 branch of Kubernetes
    nodeset: ubuntu-xenial-k8s-cluster-cpo
    vars:
      go_version: '1.15'
      k8s_version: 'release-1.19'
      etcd_version: 'v3.4.9'
      kubernetes_version: 'v1.19.0'
    tags:
      - Category:Cloud
      - Project:kubernetes/cloud-provider-openstack
      - Application:cloud-provider-openstack@release-1.19
      - Application:Kubernetes@release-1.19
      - Application:Docker.io@v18.09
      - Application:Etcd@v3.4.9
      - Application:Go@1.15
      - OS:ubuntu-xenial
      - Arch:x86_64
      - BuildType:Integration test

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-stable-branch-v1.20
    parent: cloud-provider-openstack-acceptance-test-e2e-conformance
    description: |
      Run Kubernetes E2E Conformance tests against v1.20 release of Kubernetes(k3s)
    nodeset: ubuntu-focal-large
    vars:
      k8s_release: 'release-1.20'
    tags:
      - Category:Cloud
      - Project:kubernetes/cloud-provider-openstack
      - Application:cloud-provider-openstack@release-1.20
      - Application:Kubernetes@release-1.20
      - Arch:x86_64
      - BuildType:Integration test

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-stable-branch-v1.21
    parent: cloud-provider-openstack-acceptance-test-e2e-conformance
    description: |
      Run Kubernetes E2E Conformance tests against v1.21 release of Kubernetes(k3s)
    nodeset: ubuntu-focal-large
    vars:
      k8s_release: 'release-1.21'
    tags:
      - Category:Cloud
      - Project:kubernetes/cloud-provider-openstack
      - Application:cloud-provider-openstack@release-1.21
      - Application:Kubernetes@release-1.21
      - Arch:x86_64
      - BuildType:Integration test

- job:
    name: cloud-provider-openstack-acceptance-test-standalone-cinder
    parent: cloud-provider-openstack-test
    description: |
      Run cinder standalone acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-standalone-cinder/run.yaml
    post-run: playbooks/cloud-provider-openstack-acceptance-test-standalone-cinder/post.yaml
    nodeset: ubuntu-bionic
    secrets:
      - swr

- job:
    name: cloud-provider-openstack-acceptance-test-csi-cinder
    parent: cloud-provider-openstack-test
    description: |
      Run cinder csi acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-csi-cinder/run.yaml
    post-run: playbooks/cloud-provider-openstack-acceptance-test-csi-cinder/post.yaml
    nodeset: ubuntu-focal-citynetwork
    secrets:
      - citynetwork_credentials
      - swr

- job:
    name: cloud-provider-openstack-e2e-test-csi-cinder
    parent: cloud-provider-openstack-test
    description: |
      Run cinder csi e2e tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-e2e-test-csi-cinder/run.yaml
    post-run: playbooks/cloud-provider-openstack-e2e-test-csi-cinder/post.yaml
    nodeset: ubuntu-focal-citynetwork
    secrets:
      - citynetwork_credentials
      - swr

- job:
    name: cloud-provider-openstack-multinode-csi-migration-test
    parent: cloud-provider-openstack-test
    description: |
      Run Kubernetes sig-storage (driver cinder) e2e test suite against a
      multinode Kubernetes Cluster with feature-gates CSIMigration,
      CSIMigrationOpenStack and ExpandCSIVolume enabled.
    pre-run: playbooks/cloud-provider-openstack-multinode-csi-migration-test/pre.yaml
    run: playbooks/cloud-provider-openstack-multinode-csi-migration-test/run.yaml
    post-run: playbooks/cloud-provider-openstack-multinode-csi-migration-test/post.yaml
    nodeset: ubuntu-xenial-k8s-cluster-cpo
    secrets:
      - citynetwork_credentials
      - swr

- job:
    name: cloud-provider-openstack-cleanup-volumes
    parent: init-test
    description: |
      Cleanup orphaned resources of volume tests
    run: playbooks/cloud-provider-openstack-cleanup-volumes/run.yaml
    nodeset: ubuntu-focal-citynetwork
    secrets:
      - citynetwork_credentials
    vars:
      cloud_name: citynetwork

- job:
    name: cloud-provider-openstack-acceptance-test-manila-provisioner
    parent: cloud-provider-openstack-test
    description: |
      Run Manila provisioner acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-manila-provisioner/run.yaml
    post-run: playbooks/cloud-provider-openstack-acceptance-test-manila-provisioner/post.yaml
    nodeset: ubuntu-bionic
    secrets:
      - swr

- job:
    name: cloud-provider-openstack-acceptance-test-csi-manila
    parent: cloud-provider-openstack-test
    description: |
      Run manila csi acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-csi-manila/run.yaml
    post-run: playbooks/cloud-provider-openstack-acceptance-test-csi-manila/post.yaml
    nodeset: ubuntu-focal
    secrets:
      - swr

- job:
    name: cloud-provider-openstack-acceptance-test-lb-octavia
    parent: cloud-provider-openstack-test
    description: |
      Run lb acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-lb-octavia/run.yaml
    post-run: playbooks/cloud-provider-openstack-acceptance-test-lb-octavia/post.yaml
    nodeset: ubuntu-bionic
    vars:
      k8s_os_provider_src_dir: '{{ ansible_user_dir }}/src/k8s.io/cloud-provider-openstack'
      k8s_src_dir: '{{ ansible_user_dir }}/src/k8s.io/kubernetes'
      k8s_log_dir: '{{ ansible_user_dir }}/workspace/logs/kubernetes'
      kubectl: '{{ ansible_user_dir }}/src/k8s.io/kubernetes/cluster/kubectl.sh'
    secrets:
      - kubeconfig
      - swr

- job:
    name: cloud-provider-openstack-test-occm
    parent: cloud-provider-openstack-test
    description: |
      Functional test for openstack-cloud-controller-manager
    run: playbooks/cloud-provider-openstack-test-occm/run.yaml
    nodeset: ubuntu-focal-large
    vars:
      cpo_src_dir: '{{ ansible_user_dir }}/src/k8s.io/cloud-provider-openstack'
    secrets:
      - swr

- job:
    name: cloud-provider-openstack-test-occm-1.21
    parent: cloud-provider-openstack-test
    description: |
      Functional test for openstack-cloud-controller-manager release-1.21
    run: playbooks/cloud-provider-openstack-test-occm/run-1.21.yaml
    nodeset: ubuntu-focal-large
    vars:
      cpo_src_dir: '{{ ansible_user_dir }}/src/k8s.io/cloud-provider-openstack'
    secrets:
      - swr

- job:
    name: cloud-provider-openstack-test-occm-1.20
    parent: cloud-provider-openstack-test
    description: |
      Functional test for openstack-cloud-controller-manager release-1.20
    run: playbooks/cloud-provider-openstack-test-occm/run-1.20.yaml
    nodeset: ubuntu-focal-large
    vars:
      cpo_src_dir: '{{ ansible_user_dir }}/src/k8s.io/cloud-provider-openstack'
    secrets:
      - swr

- job:
    name: cloud-provider-openstack-test-occm-1.19
    parent: cloud-provider-openstack-test
    description: |
      Functional test for openstack-cloud-controller-manager release-1.19
    run: playbooks/cloud-provider-openstack-test-occm/run-1.19.yaml
    nodeset: ubuntu-focal-large
    vars:
      cpo_src_dir: '{{ ansible_user_dir }}/src/k8s.io/cloud-provider-openstack'
    secrets:
      - swr

- job:
    name: cloud-provider-openstack-acceptance-test-keystone-authentication-authorization
    parent: cloud-provider-openstack-test
    description: |
      Run keystone auth acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-keystone-authentication-authorization/run.yaml
    nodeset: ubuntu-focal
    secrets:
      - swr

- job:
    name: cloud-provider-openstack-acceptance-test-flexvolume-cinder
    parent: cloud-provider-openstack-test
    description: |
      Run cinder flexvolume acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-flexvolume-cinder/run.yaml
    nodeset: ubuntu-bionic
    secrets:
      - swr

- job:
    name: labkeeper-allinone-deployment-test
    parent: init-test
    description: |
      Try to deploy allinone openlab CI environment with labkeeper
    run: playbooks/labkeeper-allinone-deployment-test/run.yaml

- job:
    name: ai-on-openlab-test-vm
    parent: init-test
    description: |
      Train and inference AI model in openlab VM.
    run: playbooks/ai-on-openlab/run.yaml
    nodeset: ubuntu-xenial
    secrets:
      - moo_github_account
    vars:
      is_gpu_enabled: false

- job:
    name: ai-on-openlab-test-vm-with-gpu
    parent: init-test
    description: |
      Train and inference AI model on GPU in openlab VM.
    run: playbooks/ai-on-openlab/run.yaml
    nodeset: ubuntu-xenial-gpu
    secrets:
      - moo_github_account
    vars:
      is_gpu_enabled: true

- job:
    name: flink-test-base
    parent: init-test
    description: |
      The flink base test
    nodeset: ubuntu-xenial-arm64-flink-docker
    timeout: 21600

- job:
    name: flink-end-to-end-test-cron-openlab
    parent: flink-test-base
    description: |
      The flink e2e test - openlab
    run: playbooks/flink-end-to-end-test/e2e_cron_openlab.yaml
    post-run: playbooks/flink-end-to-end-test/post.yaml
    tags:
      - Category:BigData
      - Project:apache/flink
      - Application:Flink@master
      - OS:ubuntu-xenial
      - Arch:arm64
      - BuildType:Integration test
    secrets:
      - swr

- job:
    name: flink-end-to-end-test-cron-hadoop313
    parent: flink-test-base
    description: |
      The flink e2e test - hadoop313
    run: playbooks/flink-end-to-end-test/e2e_cron_hadoop313.yaml
    post-run: playbooks/flink-end-to-end-test/post.yaml
    tags:
      - Category:BigData
      - Project:apache/flink
      - Application:Flink@master
      - OS:ubuntu-xenial
      - Arch:arm64
      - BuildType:Integration test
    secrets:
      - swr

- job:
    name: flink-end-to-end-test-cron-hadoop241
    parent: flink-test-base
    description: |
      The flink e2e test - hadoop241
    run: playbooks/flink-end-to-end-test/e2e_cron_hadoop241.yaml
    post-run: playbooks/flink-end-to-end-test/post.yaml
    tags:
      - Category:BigData
      - Project:apache/flink
      - Application:Flink@master
      - OS:ubuntu-xenial
      - Arch:arm64
      - BuildType:Integration test
    secrets:
      - swr

- job:
    name: flink-end-to-end-test-cron-hadoop241-test
    parent: flink-test-base
    description: |
      The flink e2e test - hadoop241
    run: playbooks/flink-end-to-end-test/e2e_cron_hadoop241_test.yaml
    post-run: playbooks/flink-end-to-end-test/post.yaml
    tags:
      - Category:BigData
      - Project:apache/flink
      - Application:Flink@master
      - OS:ubuntu-xenial
      - Arch:arm64
      - BuildType:Integration test
    secrets:
      - swr

- job:
    name: flink-end-to-end-test-cron-jdk11
    parent: flink-test-base
    description: |
      The flink e2e test - jdk11
    run: playbooks/flink-end-to-end-test/e2e_cron_jdk11.yaml
    post-run: playbooks/flink-end-to-end-test/post.yaml
    tags:
      - Category:BigData
      - Project:apache/flink
      - Application:Flink@master
      - OS:ubuntu-xenial
      - Arch:arm64
      - BuildType:Integration test
    secrets:
      - swr

- job:
    name: flink-end-to-end-test-cron-scala212
    parent: flink-test-base
    description: |
      The flink e2e test - scala212
    run: playbooks/flink-end-to-end-test/e2e_cron_scala212.yaml
    post-run: playbooks/flink-end-to-end-test/post.yaml
    tags:
      - Category:BigData
      - Project:apache/flink
      - Application:Flink@master
      - OS:ubuntu-xenial
      - Arch:arm64
      - BuildType:Integration test
    secrets:
      - swr

- job:
    name: flink-build-and-test-arm64-core-and-tests
    parent: flink-test-base
    description: |
      The flink-core build and test on ARM for core and tests component.
    run: playbooks/flink-end-to-end-test/build_and_test_core_and_tests.yaml
    tags:
      - Category:BigData
      - Project:apache/flink
      - Application:Flink@master
      - OS:ubuntu-xenial
      - Arch:arm64
      - BuildType:Unit test

- job:
    name: flink-build-and-test-arm64-libraies-and-blink_planner
    parent: flink-test-base
    description: |
      The flink-core build and test on ARM for libraies and blink_planner component.
    run: playbooks/flink-end-to-end-test/build_and_test_libraies_and_blink_planner.yaml
    tags:
      - Category:BigData
      - Project:apache/flink
      - Application:Flink@master
      - OS:ubuntu-xenial
      - Arch:arm64
      - BuildType:Unit test

- job:
    name: flink-build-and-test-arm64-kafka_gelly-and-connectors
    parent: flink-test-base
    description: |
      The flink-core build and test on ARM for kafka_gelly and connectors component.
    run: playbooks/flink-end-to-end-test/build_and_test_kafka_gelly_and_connectors.yaml
    tags:
      - Category:BigData
      - Project:apache/flink
      - Application:Flink@master
      - OS:ubuntu-xenial
      - Arch:arm64
      - BuildType:Unit test

- job:
    name: flink-build-and-test-arm64-misc
    parent: flink-test-base
    description: |
      The flink-core build and test on ARM for misc component.
    run: playbooks/flink-end-to-end-test/build_and_test_misc.yaml
    tags:
      - Category:BigData
      - Project:apache/flink
      - Application:Flink@master
      - OS:ubuntu-xenial
      - Arch:arm64
      - BuildType:Unit test

- job:
    name: flink-build-and-test-arm64-scheduler-ng-core-and-ng-tests
    parent: flink-test-base
    description: |
      The flink-core build and test on ARM for scheduler_ng_core and scheduler_ng_tests case.
    run: playbooks/flink-end-to-end-test/build_and_test_scheduler_ng_core_and_ng_tests.yaml
    tags:
      - Category:BigData
      - Project:apache/flink
      - Application:Flink@master
      - OS:ubuntu-xenial
      - Arch:arm64
      - BuildType:Unit test

- job:
    name: frocksdb-build-and-test-arm64
    parent: init-test
    description: |
      The job for Frocksdb build and test on ARM64
    run: playbooks/frocksdb-build-and-test/build_and_test.yaml
    nodeset: ubuntu-xenial-arm64-flink-docker
    tags:
      - Category:BigData
      - Project:dataArtisans/frocksdb
      - Application:frocksdb@5.17.2
      - OS:ubuntu-xenial
      - Arch:arm64
      - BuildType:Unit test
    timeout: 18000

- job:
    name: gpdb-installcheck-world-tests-on-arm64
    parent: init-test
    description: |
      The GreenPlum build and tests all the regression tests with demo cluster.
    run: playbooks/gpdb-installcheck-world-tests-on-arm64/run.yaml
    post-run: playbooks/gpdb-installcheck-world-tests-on-arm64/post.yaml
    nodeset: ubuntu-bionic-arm64-huaweicloud-official
    tags:
      - Category:Database
      - Project:greenplum-db/gpdb
      - Application:gpdb@master
      - OS:ubuntu-bionic
      - Arch:arm64
      - BuildType:Unit test
    timeout: 18000

- job:
    name: kudu-build-test-arm64-in-docker
    parent: init-test
    description: |
      Apache Kudu build and test on arm64 server
    run: playbooks/kudu-build-test-arm64/run.yaml
    nodeset: ubuntu-bionic-arm64-huaweicloud-16u32g
    secrets:
      - private_docker_registry
    vars:
      build_types:
        - lint
        - iwyu
        - debug
        - release
    tags:
      - Category:BigData
      - Project:apache/kudu
      - Application:Kudu@master
      - OS:ubuntu-bionic
      - Arch:arm64
      - BuildType:Unit test
    timeout: 18000

- job:
    name: impala-build-test-arm64
    parent: init-test
    description: |
      Apache Impala build and test on arm64 server
    run: playbooks/impala-build-test-arm64/run.yaml
    nodeset: ubuntu-bionic-arm64-huaweicloud-impala
    tags:
      - Category:BigData
      - Project:apache/impala
      - Application:Impala@master
      - OS:ubuntu-bionic
      - Arch:arm64
      - BuildType:Unit test
    timeout: 72000

- job:
    name: storm-build-test-arm64
    parent: init-test
    description: |
      Apache Storm build and test on arm64 server
    run: playbooks/storm-build-test-arm64/run.yaml
    nodeset: ubuntu-bionic-arm64-huaweicloud-8u16g
    tags:
      - Category:BigData
      - Project:apache/storm
      - Application:Storm@master
      - OS:ubuntu-bionic
      - Arch:arm64
      - BuildType:Unit test
    timeout: 18000

- job:
    name: hadoop-2.7.7-openeuler-build-test
    parent: init-test
    description: |
      Run tests of Hadoop 2.7.7 version on openEuler
    run: playbooks/hadoop-2.7.7-openeuler-build-test/run.yaml
    nodeset: ubuntu-bionic-arm64-huaweicloud-8u16g
    tags:
      - Category:BigData
      - Project:kunpengcompute/hadoop
      - Application:Hadoop@release-2.7.7-aarch64
      - OS:ubuntu-bionic
      - Arch:arm64
      - BuildType:Unit test
    timeout: 54000

- job:
    name: pytorch-arm64-build-daily
    parent: init-test
    description: |
      Base job for Pytorch daily build on ARM64
    run: playbooks/pytorch-arm-build/run.yaml
    nodeset: ubuntu-bionic-arm64-huaweicloud-8u16g
    tags:
      - Category:AI
      - Project:Pytorch/Pytorch
      - Application:Pytorch@master
      - OS:ubuntu-bionic
      - Arch:arm64
      - BuildType:Build
    timeout: 18000
    vars:
      global_env:
        RELEASE: master
        PYTHON: v3.6

- job:
    name: pytorch-arm64-build-daily-master-py36
    parent: pytorch-arm64-build-daily
    description: |
      Pytorch Master daily build on ARM64 - py36

- job:
    name: pytorch-arm64-build-daily-master-py37
    parent: pytorch-arm64-build-daily
    description: |
      Pytorch Master daily build on ARM64 - py37
    vars:
      global_env:
        PYTHON: v3.7

- job:
    name: pytorch-arm64-build-daily-master-py38
    parent: pytorch-arm64-build-daily
    description: |
      Pytorch Master daily build on ARM64 - py38
    vars:
      global_env:
        PYTHON: v3.8

- job:
    name: pytorch-arm64-build-daily-v1.7.1
    parent: pytorch-arm64-build-daily
    description: |
      Pytorch V1.7.1 daily build on ARM64
    vars:
      global_env:
        RELEASE: v1.7.1

- job:
    name: pytorch-arm64-build-daily-v1.8.1
    parent: pytorch-arm64-build-daily
    description: |
      Pytorch V1.8.1 daily build on ARM64
    vars:
      global_env:
        RELEASE: v1.8.1

- job:
    name: pytorch-arm64-build-daily-v1.9.0
    parent: pytorch-arm64-build-daily
    description: |
      Pytorch V1.9.0 daily build on ARM64
    vars:
      global_env:
        RELEASE: v1.9.0

- job:
    name: tensorflow-arm64-build-daily
    parent: init-test
    description: |
      Tensorflow daily build on ARM64
    run: playbooks/tensorflow-arm-build/run.yaml
    nodeset: ubuntu-bionic-arm64-huaweicloud-8u16g
    tags:
      - Category:AI
      - Project:Tensorflow/Tensorflow
      - Application:Tensorflow@master
      - OS:ubuntu-bionic
      - Arch:arm64
      - BuildType:Build
    timeout: 54000

- job:
    name: tensorflow-arm64-build-daily-master
    parent: tensorflow-arm64-build-daily
    description: |
      Tensorflow Master daily build on ARM64
    vars:
      global_env:
        RELEASE: master
        BAZEL_VERSION: 3.7.2
        GCC_VERSION: default
        PYTHON: v3.6

- job:
    name: tensorflow-arm64-release-build-v1.15.3
    parent: tensorflow-arm64-build-daily
    description: |
      Tensorflow v1.15.3 release build on ARM64
    vars:
      global_env:
        RELEASE: v1.15.3
        BAZEL_VERSION: 0.24.1
        GCC_VERSION: default

- job:
    name: tensorflow-arm64-release-build-v1.15.3-py35
    parent: tensorflow-arm64-release-build-v1.15.3
    description: |
      Tensorflow v1.15.3 release build on ARM64 with python3.5
    provides: tf-cpu-whl-ready-for-1.15.3-py35
    vars:
      global_env:
        PYTHON: v3.5

- job:
    name: tensorflow-arm64-release-build-v1.15.3-py36
    parent: tensorflow-arm64-release-build-v1.15.3
    description: |
      Tensorflow v1.15.3 release build on ARM64 with python3.6
    provides: tf-cpu-whl-ready-for-1.15.3-py36
    vars:
      global_env:
        PYTHON: v3.6

- job:
    name: tensorflow-arm64-release-build-v1.15.3-py37
    parent: tensorflow-arm64-release-build-v1.15.3
    description: |
      Tensorflow v1.15.3 release build on ARM64 with python3.7
    provides: tf-cpu-whl-ready-for-1.15.3-py37
    vars:
      global_env:
        PYTHON: v3.7

- job:
    name: tensorflow-arm64-release-build-v2.1.0
    parent: tensorflow-arm64-build-daily
    description: |
      Tensorflow v2.1.0 release build on ARM64
    vars:
      global_env:
        RELEASE: v2.1.0
        BAZEL_VERSION: 0.29.1
        GCC_VERSION: default

- job:
    name: tensorflow-arm64-release-build-v2.1.0-py35
    parent: tensorflow-arm64-release-build-v2.1.0
    description: |
      Tensorflow v2.1.0 release build on ARM64 with python3.5
    provides: tf-cpu-whl-ready-for-2.1.0-py35
    vars:
      global_env:
        PYTHON: v3.5

- job:
    name: tensorflow-arm64-release-build-v2.1.0-py36
    parent: tensorflow-arm64-release-build-v2.1.0
    description: |
      Tensorflow v2.1.0 release build on ARM64 with python3.6
    provides: tf-cpu-whl-ready-for-2.1.0-py36
    vars:
      global_env:
        PYTHON: v3.6

- job:
    name: tensorflow-arm64-release-build-v2.1.0-py37
    parent: tensorflow-arm64-release-build-v2.1.0
    description: |
      Tensorflow v2.1.0 release build on ARM64 with python3.7
    provides: tf-cpu-whl-ready-for-2.1.0-py37
    vars:
      global_env:
        PYTHON: v3.7

- job:
    name: tensorflow-arm64-release-build-v2.1.0-py38
    parent: tensorflow-arm64-release-build-v2.1.0
    description: |
      Tensorflow v2.1.0 release build on ARM64 with python3.8
    provides: tf-cpu-whl-ready-for-2.1.0-py38
    vars:
      global_env:
        PYTHON: v3.8

- job:
    name: tensorflow-arm64-release-build-show
    parent: init-test
    description: |
      Tensorflow release build whl download links on ARM64 with supported python versions.
    run: playbooks/tensorflow-arm-build/run_release.yaml
    nodeset: ubuntu-bionic-arm64-huaweicloud-8u16g
    tags:
      - Category:AI
      - Project:Tensorflow/Tensorflow
      - Application:Tensorflow@master
      - OS:ubuntu-bionic
      - Arch:arm64
      - BuildType:Release
    timeout: 54000

- job:
    name: tensorflow-v1.15.3-cpu-arm64-release-build-show
    parent: tensorflow-arm64-release-build-show
    description: |
      Tensorflow CPU 1.15.3 release build whl download links on ARM64 with supported python versions.
    requires:
      - tf-cpu-whl-ready-for-1.15.3-py35
      - tf-cpu-whl-ready-for-1.15.3-py36
      - tf-cpu-whl-ready-for-1.15.3-py37
    dependencies:
      - tensorflow-arm64-release-build-v1.15.3-py35
      - tensorflow-arm64-release-build-v1.15.3-py36
      - tensorflow-arm64-release-build-v1.15.3-py37
    vars:
      global_env:
        RELEASE: v1.15.3

- job:
    name: tensorflow-v2.1.0-cpu-arm64-release-build-show
    parent: tensorflow-arm64-release-build-show
    description: |
      Tensorflow CPU 2.1.0 release build whl download links on ARM64 with supported python versions.
    requires:
      - tf-cpu-whl-ready-for-2.1.0-py35
      - tf-cpu-whl-ready-for-2.1.0-py36
      - tf-cpu-whl-ready-for-2.1.0-py37
      - tf-cpu-whl-ready-for-2.1.0-py38
    dependencies:
      - tensorflow-arm64-release-build-v2.1.0-py35
      - tensorflow-arm64-release-build-v2.1.0-py36
      - tensorflow-arm64-release-build-v2.1.0-py37
      - tensorflow-arm64-release-build-v2.1.0-py38
    vars:
      global_env:
        RELEASE: v2.1.0

- job:
    name: mysql-full-test-on-arm64
    parent: init-test
    description: |
      Full test for mysql on arm64.
    run: playbooks/mysql-test-on-arm64/run.yaml
    nodeset: ubuntu-bionic-arm64-huaweicloud-8u16g
    tags:
      - Category:Database
      - Project:mysql/mysql-server
      - Application:mysql-server@master
      - OS:ubuntu-bionic
      - Arch:arm64
      - BuildType:Test
    timeout: 86400
    vars:
      global_env:
        RELEASE: "refs/heads/8.0"
        IS_OPTIMIZED: 'no'
        GOOGLE_TEST_VERSION: 1.8.0

- job:
    name: mysql-5.7-upstream-full-test-on-arm64
    parent: mysql-full-test-on-arm64
    description: |
      Full test for mysql 5.7 upstream version on arm64.
    run: playbooks/mysql-test-on-arm64/run.yaml
    vars:
      global_env:
        RELEASE: 5.7.27
        BOOST_VERSION: 1.59.0

# Kubernetes cloud-provider-openstack jobs
- job:
    name: bucardo-unitest
    parent: init-test
    description: |
      Base job for all types of bucardo test jobs
    pre-run: playbooks/bucardo-unitest/pre.yaml
    post-run: playbooks/bucardo-unitest/post.yaml

- job:
    name: bucardo-unitest-on-X86-for-PR
    parent: bucardo-unitest
    description: |
      Run unit test of bucardo on X86
    run: playbooks/bucardo-unitest/run.yaml
    nodeset: ubuntu-bionic
    tags:
      - Category:Database
      - Project:bucardo/bucardo
      - Application:bucardo@master
      - OS:ubuntu-bionic
      - Arch:x86
      - BuildType:Test
    timeout: 86400
    vars:
      global_env:
        ARCH: 'x86'

- job:
    name: bucardo-unitest-on-X86-perl5.30-PG
    parent: bucardo-unitest-on-X86-for-PR
    description: |
      Test bucardo unitest on X86 with perl 5.30
    vars:
      global_env:
        PERL_VERSION: '5.30'

- job:
    name: bucardo-unitest-on-X86-perl5.30-PG10
    parent: bucardo-unitest-on-X86-perl5.30-PG
    description: |
      Test bucardo unitest on X86 with perl 5.30 and PG 10
    vars:
      global_env:
        PGVERSION: '10'

- job:
    name: bucardo-unitest-on-X86-perl5.30-PG11
    parent: bucardo-unitest-on-X86-perl5.30-PG
    description: |
      Test bucardo unitest on X86 with perl 5.30 and PG 11
    vars:
      global_env:
        PGVERSION: '11'

- job:
    name: bucardo-unitest-on-X86-perl5.30-PG12
    parent: bucardo-unitest-on-X86-perl5.30-PG
    description: |
      Test bucardo unitest on X86 with perl 5.30 and PG 12
    vars:
      global_env:
        PGVERSION: '12'

- job:
    name: bucardo-unitest-on-arm64-for-PR
    parent: bucardo-unitest
    description: |
      Run unit test of bucardo
    run: playbooks/bucardo-unitest/run.yaml
    nodeset: ubuntu-bionic-arm64-huaweicloud-8u16g
    tags:
      - Category:Database
      - Project:bucardo/bucardo
      - Application:bucardo@master
      - OS:ubuntu-bionic
      - Arch:arm64
      - BuildType:Test
    timeout: 86400
    vars:
      global_env:
        ARCH: 'arm64'

- job:
    name: bucardo-unitest-on-arm64-perl5.30-PG
    parent: bucardo-unitest-on-arm64-for-PR
    description: |
      Test bucardo unitest on aarch64 with perl 5.30
    vars:
      global_env:
        PERL_VERSION: '5.30'

- job:
    name: bucardo-unitest-on-arm64-perl5.30-PG12
    parent: bucardo-unitest-on-arm64-perl5.30-PG
    description: |
      Test bucardo unitest on aarch64 with perl 5.30 and PG 12
    vars:
      global_env:
        PGVERSION: '12'
