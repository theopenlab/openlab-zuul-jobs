# Shared jobs specific to the OpenLab Project

- job:
    name: base
    parent: null
    description: |
      A subset of what the 'base' job provides: the absolute minimum considered
      required to run for any one job.
      It doesn't set up cached git repositories, will not set up mirrors,
      doesn't validate the node and does not generate an ARA report.
      These tasks, if required, can be included by the dependant jobs
      themselves on a need basis.
    attempts: 1
    pre-run: playbooks/base/pre.yaml
    post-run:
      - playbooks/base/post-ssh.yaml
      - playbooks/base/post-logs.yaml
    roles:
      - zuul: liu-sheng/zuul-jobs
      - zuul: liu-sheng/project-config
    timeout: 1800
    nodeset: ubuntu-xenial
    secrets:
      - site_logs

# Common test base job
- job:
    name: init-test
    description: |
      Base job for all types of test jobs. Ensure workspace and copy log files.
    pre-run: playbooks/init-test/pre.yaml
    post-run: playbooks/init-test/post.yaml
    timeout: 21600
    vars:
      global_env:
        OS_BRANCH: master

# Golang test base job
- job:
    name: golang-test
    parent: init-test
    description: |
      Base job for all types of golang test jobs.
    post-run: playbooks/golang-test/post.yaml

# Terraform-provider-openstack jobs
- job:
    name: terraform-provider-openstack-unittest
    parent: golang-test
    description: |
      Run terraform provider openstack unit test
    run: playbooks/terraform-provider-openstack-unittest/run.yaml
    nodeset: ubuntu-xenial-ut

- job:
    name: terraform-provider-openstack-acceptance-test
    parent: golang-test
    description: |
      Run terraform provider openstack acceptance test on master branch
    run: playbooks/terraform-provider-openstack-acceptance-test/run.yaml

- job:
    name: terraform-provider-openstack-acceptance-test-queens
    parent: terraform-provider-openstack-acceptance-test
    description: |
      Run terraform provider openstack acceptance test on queens branch
    vars:
      global_env:
        OS_BRANCH: stable/queens

- job:
    name: terraform-provider-openstack-acceptance-test-pike
    parent: terraform-provider-openstack-acceptance-test
    description: |
      Run terraform provider openstack acceptance test on pike branch
    vars:
      global_env:
        OS_BRANCH: stable/pike
- job:
    name: terraform-provider-openstack-acceptance-test-ocata
    parent: terraform-provider-openstack-acceptance-test
    description: |
      Run terraform provider openstack acceptance test on ocata branch
    vars:
      global_env:
        OS_BRANCH: stable/ocata

- job:
    name: terraform-provider-openstack-acceptance-test-newton
    parent: terraform-provider-openstack-acceptance-test
    description: |
      Run terraform provider openstack acceptance test on newton branch
    vars:
      global_env:
        OS_BRANCH: stable/newton


- job:
    name: terraform-provider-openstack-acceptance-test-mitaka
    parent: terraform-provider-openstack-acceptance-test
    description: |
      Run terraform provider openstack acceptance test on mitaka branch
    vars:
      global_env:
        OS_BRANCH: stable/mitaka
    nodeset: ubuntu-trusty

- job:
    name: terraform-provider-openstack-acceptance-test-designate
    parent: golang-test
    description: |
      Run terraform provider openstack designate acceptance test on master branch
    run: playbooks/terraform-provider-openstack-acceptance-test-designate/run.yaml

- job:
    name: terraform-provider-openstack-acceptance-test-trove
    parent: golang-test
    description: |
      Run terraform-provider-openstack trove acceptance test on master branch
    run: playbooks/terraform-provider-openstack-acceptance-test-trove/run.yaml

- job:
    name: terraform-provider-openstack-acceptance-test-lbaas
    parent: golang-test
    description: |
      Run terraform provider openstack lbaas acceptance test on master branch
    run: playbooks/terraform-provider-openstack-acceptance-test-lbaas/run.yaml

- job:
    name: terraform-provider-openstack-acceptance-test-fwaas
    parent: golang-test
    description: |
      Run terraform provider openstack fwaas acceptance test on master branch
    run: playbooks/terraform-provider-openstack-acceptance-test-fwaas/run.yaml

# terraform-provider-openstack acceptance tests with Telefonica cloud
- job:
    name: terraform-provider-openstack-acceptance-test-telefonica
    parent: golang-test
    description: |
      Run acceptance tests of terraform-provider-openstack repo against telefonica cloud
    run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/run.yaml
    post-run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/post.yaml
    secrets:
      - telefonica_credentials
    vars:
      cloud_name: telefonica

# terraform-provider-openstack acceptance tests with Open Telekom cloud
- job:
    name: terraform-provider-openstack-acceptance-test-opentelekomcloud
    parent: golang-test
    description: |
      Run acceptance tests of terraform-provider-openstack repo against opentelekomcloud
    run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/run.yaml
    post-run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/post.yaml
    secrets:
      - opentelekomcloud_credentials
    vars:
      cloud_name: opentelekomcloud

# terraform-provider-openstack acceptance tests with orange cloud
- job:
    name: terraform-provider-openstack-acceptance-test-orange
    parent: golang-test
    description: |
      Run acceptance tests of terraform-provider-openstack repo against orange cloud
    run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/run.yaml
    post-run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/post.yaml
    secrets:
      - orange_credentials
    vars:
      cloud_name: orange

# terraform-provider-openstack acceptance tests with huawei cloud
- job:
    name: terraform-provider-openstack-acceptance-test-huaweicloud
    parent: golang-test
    description: |
      Run acceptance tests of terraform-provider-openstack repo against huaweicloud
    run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/run.yaml
    post-run: playbooks/terraform-provider-openstack-acceptance-test-public-clouds/post.yaml
    secrets:
      - huaweicloud_credentials
    vars:
      cloud_name: huaweicloud

# Gophercloud acceptance tests with Telefonica cloud
- job:
    name: gophercloud-acceptance-test-telefonica
    parent: golang-test
    description: |
      Run gophercloud acceptance test against telefonica cloud
    run: playbooks/gophercloud-acceptance-test-telefonica/run.yaml
    #secrets:
    #  - telefonica_credentials

# terraform-provider-telefonicaopencloud acceptance tests with Telefonica cloud
- job:
    name: terraform-provider-telefonicaopencloud-acceptance-test-telefonica
    parent: golang-test
    description: |
      Run acceptance tests of terraform-provider-telefonicaopencloud repo against telefonica cloud
    run: playbooks/terraform-provider-telefonicaopencloud-acceptance-test-telefonica/run.yaml
    #secrets:
    #  - telefonica_credentials


# terraform-provider-flexibleengine acceptance tests with orange cloud
- job:
    name: terraform-provider-flexibleengine-acceptance-test-orange
    parent: golang-test
    description: |
      Run acceptance tests of terraform-provider-flexibleengine repo against orange cloud
    run: playbooks/terraform-provider-flexibleengine-acceptance-test-orange/run.yaml
    #secrets:
    #  - orange_credentials

# terraform-provider-opentelekomcloud acceptance tests with Open Telekom cloud
- job:
    name: terraform-provider-opentelekomcloud-acceptance-test-opentelekomcloud
    parent: golang-test
    description: |
      Run acceptance tests of terraform-provider-opentelekomcloud repo against open telekom cloud
    run: playbooks/terraform-provider-opentelekomcloud-acceptance-test-opentelekomcloud/run.yaml
    secrets:
      - opentelekomcloud_credentials

# OpenLab job self-check jobs
- job:
    name: openlab-zuul-jobs-check
    parent: init-test
    description: |
      This job runs against project-config, openlab-zuul-jobs and zuul-jobs
      so we can properly lint our ansible playbooks / roles
    required-projects:
      - liu-sheng/openlab-zuul-jobs
      - liu-sheng/project-config
      - liu-sheng/zuul-jobs
    run: playbooks/openlab-zuul-jobs-check/run.yaml
    vars:
      excluded_path: "playbooks/base/*"

# Deprecated (Kubernetes nested scenario)
- job:
    name: cloud-provider-openstack-unittest-nested
    parent: golang-test
    description: |
      Run Kubernetes openstack-cloud-controller-manager unit test in devstack instance
    run: playbooks/cloud-provider-openstack-unittest-nested/run.yaml
    nodeset: ubuntu-xenial-otc

# Kubernetes cloud-provider-openstack jobs
- job:
    name: cloud-provider-openstack-test
    parent: golang-test
    description: |
      Run unit test of cloud-provider-openstack repo against vexxhost cloud
    pre-run: playbooks/cloud-provider-openstack-test/pre.yaml
    post-run: playbooks/cloud-provider-openstack-test/post.yaml
    nodeset: ubuntu-xenial-vexxhost
    secrets:
      - vexxhost_credentials
    vars:
      k8s_os_provider_src_dir: '{{ ansible_user_dir }}/src/k8s.io/cloud-provider-openstack'
      k8s_src_dir: '{{ ansible_user_dir }}/src/k8s.io/kubernetes'
      k8s_log_dir: '{{ ansible_user_dir }}/workspace/logs/kubernetes'
      kubectl: '{{ ansible_user_dir }}/src/k8s.io/kubernetes/cluster/kubectl.sh'

- job:
    name: cloud-provider-openstack-unittest
    parent: cloud-provider-openstack-test
    description: |
      Run unit test of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-unittest/run.yaml
    secrets:
      - vexxhost_credentials

- job:
    name: cloud-provider-openstack-format
    parent: golang-test
    description: |
      Run gofmt and typo checking of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-format/run.yaml
    vars:
      k8s_os_provider_src_dir: '{{ ansible_user_dir }}/src/k8s.io/cloud-provider-openstack'

- job:
    name: cloud-provider-openstack-acceptance-test-k8s-cinder
    parent: cloud-provider-openstack-test
    description: |
      Run cinder in-tree acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-k8s-cinder/run.yaml
    post-run: playbooks/cloud-provider-openstack-acceptance-test-k8s-cinder/post.yaml
    secrets:
      - vexxhost_credentials

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance
    parent: cloud-provider-openstack-test
    description: |
      Run Kubernetes E2E Conformance tests against Kubernetes master
    run: playbooks/cloud-provider-openstack-acceptance-test-e2e-conformance/run.yaml
    post-run: playbooks/cloud-provider-openstack-acceptance-test-e2e-conformance/post.yaml
    secrets:
      - vexxhost_credentials

- job:
    name: cloud-provider-openstack-acceptance-test-e2e-conformance-stable-branch-v1.10
    parent: cloud-provider-openstack-acceptance-test-e2e-conformance
    description: |
      Run Kubernetes E2E Conformance tests against Kubernetes v1.10
    vars:
      k8s_version: 'v1.10.0'

- job:
    name: cloud-provider-openstack-acceptance-test-standalone-cinder
    parent: cloud-provider-openstack-test
    description: |
      Run cinder standalone acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-standalone-cinder/run.yaml
    post-run: playbooks/cloud-provider-openstack-acceptance-test-standalone-cinder/post.yaml
    nodeset: ubuntu-xenial

- job:
    name: cloud-provider-openstack-acceptance-test-csi-cinder
    parent: cloud-provider-openstack-test
    description: |
      Run cinder csi acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-csi-cinder/run.yaml
    post-run: playbooks/cloud-provider-openstack-acceptance-test-csi-cinder/post.yaml
    secrets:
      - vexxhost_credentials

- job:
    name: cloud-provider-openstack-acceptance-test-lb-octavia
    parent: cloud-provider-openstack-test
    description: |
      Run lb acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-lb-octavia/run.yaml
    post-run: playbooks/cloud-provider-openstack-acceptance-test-lb-octavia/post.yaml
    secrets:
      - vexxhost_credentials

- job:
    name: cloud-provider-openstack-acceptance-test-keystone-authentication-authorization
    parent: cloud-provider-openstack-test
    description: |
      Run keystone auth acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-keystone-authentication-authorization/run.yaml
    nodeset: ubuntu-xenial

- job:
    name: cloud-provider-openstack-acceptance-test-flexvolume-cinder
    parent: cloud-provider-openstack-test
    description: |
      Run cinder flexvolume acceptance tests of cloud-provider-openstack
    run: playbooks/cloud-provider-openstack-acceptance-test-flexvolume-cinder/run.yaml
    nodeset: ubuntu-xenial

- job:
    name: cf-openstack-validator-acceptance-test-newton
    parent: init-test
    description: |
      This job validation tests of cf-openstack-validator aganist newton devstack
    run: playbooks/cf-openstack-validator-acceptance-test/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/newton

- job:
    name: cf-openstack-validator-acceptance-test-mitaka
    parent: init-test
    description: |
      This job validation tests of cf-openstack-validator aganist mitaka devstack
    run: playbooks/cf-openstack-validator-acceptance-test/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/mitaka
    nodeset: ubuntu-trusty

- job:
    name: cf-openstack-validator-acceptance-test-ocata
    parent: init-test
    description: |
      This job validation tests of cf-openstack-validator aganist ocata devstack
    run: playbooks/cf-openstack-validator-acceptance-test/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/ocata

- job:
    name: cf-openstack-validator-acceptance-test-pike
    parent: init-test
    description: |
      This job validation tests of cf-openstack-validator aganist pike devstack
    run: playbooks/cf-openstack-validator-acceptance-test/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/pike

- job:
    name: cf-openstack-validator-acceptance-test-queens
    parent: init-test
    description: |
      This job validation tests of cf-openstack-validator aganist pike devstack
    run: playbooks/cf-openstack-validator-acceptance-test/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/queens

- job:
    name: bosh-openstack-cpi-release-acceptance-test
    parent: init-test
    description: |
      This job validation tests of bosh-openstack-cpi-release aganist OpenStack master branch
    run: playbooks/bosh-openstack-cpi-release-acceptance-test/run.yaml

- job:
    name: bosh-openstack-cpi-release-acceptance-test-queens
    parent: bosh-openstack-cpi-release-acceptance-test
    description: |
      This job validation tests of bosh-openstack-cpi-release aganist OpenStack Queens release
    vars:
      global_env:
        OS_BRANCH: stable/queens

- job:
    name: bosh-openstack-cpi-release-acceptance-test-pike
    parent: bosh-openstack-cpi-release-acceptance-test
    description: |
      This job validation tests of bosh-openstack-cpi-release aganist OpenStack Pike release
    vars:
      global_env:
        OS_BRANCH: stable/pike

- job:
    name: bosh-openstack-cpi-release-acceptance-test-ocata
    parent: bosh-openstack-cpi-release-acceptance-test
    description: |
      This job validation tests of bosh-openstack-cpi-release aganist OpenStack Ocata release
    vars:
      global_env:
        OS_BRANCH: stable/ocata

- job:
    name: bosh-openstack-cpi-release-acceptance-test-newton
    parent: bosh-openstack-cpi-release-acceptance-test
    description: |
      This job validation tests of bosh-openstack-cpi-release aganist OpenStack Newton release
    vars:
      global_env:
        OS_BRANCH: stable/newton

- job:
    name: bosh-openstack-cpi-release-acceptance-test-mitaka
    parent: bosh-openstack-cpi-release-acceptance-test
    description: |
      This job validation tests of bosh-openstack-cpi-release aganist OpenStack Mitaka release
    vars:
      global_env:
        OS_BRANCH: stable/mitaka
    nodeset: ubuntu-trusty

- job:
    name: bosh-acceptance-test-opentelekomcloud
    parent: init-test
    description: |
      Run acceptance tests of bosh-acceptance-test against opentelekomcloud
    run: playbooks/bosh-acceptance-test-public-clouds/run.yaml
    post-run: playbooks/bosh-acceptance-test-public-clouds/post.yaml
    nodeset: ubuntu-xenial-otc
    secrets:
      - opentelekomcloud_credentials

- job:
    name: bosh-acceptance-tests-devstack
    parent: golang-test
    description: |
      Run cloudfoundry acceptance tests of bosh-acceptance-tests
    run: playbooks/bosh-acceptance-tests-devstack/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/newton
    nodeset: ubuntu-xenial-large

#- job:
#    name: openstacksdk-ansible-devel-functional-devstack
#    parent: init-test
#    description: |
#      Run openstacksdk ansible functional tests against a master devstack
#      using git devel branch version of ansible.
#    run: playbooks/ansible-functional-devstack/run.yaml
#    required-projects:
#      - name: liu-sheng/ansible
#        override-checkout: devel
#      - openstack/openstacksdk
#    vars:
#      os_sdk: openstacksdk
#
#- job:
#    name: openstacksdk-ansible-stable-2.6-functional-devstack
#    parent: init-test
#    description: |
#      Run openstacksdk ansible functional tests against a master devstack
#      using git stable-2.6 branch version of ansible.
#    run: playbooks/ansible-functional-devstack/run.yaml
#    required-projects:
#      - name: liu-sheng/ansible
#        override-checkout: stable-2.6
#      - openstack/openstacksdk
#    vars:
#      os_sdk: openstacksdk
#
#- job:
#    name: shade-ansible-stable-2.5-functional-devstack
#    parent: init-test
#    description: |
#      Run shade ansible functional tests against a master devstack
#      using git stable-2.5 branch version of ansible.
#    run: playbooks/ansible-functional-devstack/run.yaml
#    required-projects:
#      - name: liu-sheng/ansible
#        override-checkout: stable-2.5
#      - openstack-infra/shade
#    vars:
#      os_sdk: shade
#
#- job:
#    name: openstacksdk-ansible-stable-2.6-functional-opentelekomcloud
#    parent: init-test
#    description: |
#      Run openstacksdk ansible functional tests against a opentelekomcloud
#      using git stable-2.6 branch version of ansible.
#    run: playbooks/ansible-functional-public-clouds/run.yaml
#    required-projects:
#      - name: liu-sheng/ansible
#        override-checkout: stable-2.6
#      - openstack/openstacksdk
#    vars:
#      cloud_name: opentelekomcloud
#      os_sdk: openstacksdk
#    secrets:
#      - opentelekomcloud_credentials
#
#- job:
#    name: openstacksdk-ansible-stable-2.6-functional-orange
#    parent: init-test
#    description: |
#      Run openstacksdk ansible functional tests against orange cloud
#      using git stable-2.6 branch version of ansible.
#    run: playbooks/ansible-functional-public-clouds/run.yaml
#    required-projects:
#      - name: liu-sheng/ansible
#        override-checkout: stable-2.6
#      - openstack/openstacksdk
#    vars:
#      cloud_name: orange
#      os_sdk: openstacksdk
#    secrets:
#      - orange_credentials

# ansible jobs
- job:
    name: openstacksdk-ansible-devel-functional-devstack
    parent: init-test
    description: |
      Run openstacksdk ansible functional tests against a master devstack using git devel branch version of ansible.
    run: playbooks/ansible-functional-devstack/run.yaml
    required-projects:
      - openstack/openstacksdk
      - name: liu-sheng/ansible
        override-checkout: devel
    vars:
      os_sdk: openstacksdk

- job:
    name: openstacksdk-ansible-functional-devstack
    parent: init-test
    description: |
      Run openstacksdk ansible functional tests against a master devstack using git stable-2.7 branch version of ansible.
    run: playbooks/ansible-functional-devstack/run.yaml
    required-projects:
      - openstack/openstacksdk
    vars:
      os_sdk: openstacksdk
    override-checkout: stable-2.7

- job:
    name: openstacksdk-ansible-functional-devstack-rocky
    parent: init-test
    description: |
      Run openstacksdk ansible functional tests against a rocky devstack using git stable-2.7 branch version of ansible.
    run: playbooks/ansible-functional-devstack/run.yaml
    required-projects:
      - openstack/openstacksdk
    vars:
      os_sdk: openstacksdk
      global_env:
        OS_BRANCH: stable/rocky
    override-checkout: stable-2.7

- job:
    name: openstacksdk-ansible-functional-devstack-queens
    parent: init-test
    description: |
      Run openstacksdk ansible functional tests against a queens devstack using git stable-2.7 branch version of ansible.
    run: playbooks/ansible-functional-devstack/run.yaml
    required-projects:
      - openstack/openstacksdk
    vars:
      os_sdk: openstacksdk
      global_env:
        OS_BRANCH: stable/queens
    override-checkout: stable-2.7

- job:
    name: openstacksdk-ansible-functional-devstack-pike
    parent: init-test
    description: |
      Run openstacksdk ansible functional tests against a pike devstack using git stable-2.7 branch version of ansible.
    run: playbooks/ansible-functional-devstack/run.yaml
    required-projects:
      - openstack/openstacksdk
      - name: liu-sheng/ansible
        override-checkout: stable-2.7
    vars:
      os_sdk: openstacksdk
      global_env:
        OS_BRANCH: stable/pike

- job:
    name: openstacksdk-ansible-functional-devstack-ocata
    parent: init-test
    description: |
      Run openstacksdk ansible functional tests against a ocata devstack using git stable-2.7 branch version of ansible.
    run: playbooks/ansible-functional-devstack/run.yaml
    required-projects:
      - openstack/openstacksdk
    vars:
      os_sdk: openstacksdk
      global_env:
        OS_BRANCH: stable/ocata
    override-checkout: stable-2.7

- job:
    name: openstacksdk-ansible-functional-devstack-newton
    parent: init-test
    description: |
      Run openstacksdk ansible functional tests against a newton devstack using git stable-2.7 branch version of ansible.
    run: playbooks/ansible-functional-devstack/run.yaml
    required-projects:
      - openstack/openstacksdk
    vars:
      os_sdk: openstacksdk
      global_env:
        OS_BRANCH: stable/newton
    override-checkout: stable-2.7

- job:
    name: openstacksdk-ansible-functional-devstack-mitaka
    parent: init-test
    description: |
      Run openstacksdk ansible functional tests against a mitaka devstac using git stable-2.7 branch version of ansible.
    run: playbooks/ansible-functional-devstack/run.yaml
    required-projects:
      - openstack/openstacksdk
    vars:
      os_sdk: openstacksdk
      global_env:
        OS_BRANCH: stable/mitaka
    nodeset: ubuntu-trusty
    override-checkout: stable-2.7

- job:
    name: shade-ansible-stable-2.5-functional-devstack
    parent: init-test
    description: |
      Run shade ansible functional tests against a master devstack
      using git stable-2.5 branch version of ansible.
    run: playbooks/ansible-functional-devstack/run.yaml
    required-projects:
      - openstack-infra/shade
    override-checkout: stable-2.5
    vars:
      os_sdk: shade

- job:
    name: openstacksdk-ansible-functional-opentelekomcloud
    parent: init-test
    description: |
      Run openstacksdk ansible functional tests against a opentelekomcloud using git stable-2.7 branch version of ansible.
    run: playbooks/ansible-functional-public-clouds/run.yaml
    required-projects:
      - openstack/openstacksdk
    vars:
      cloud_name: opentelekomcloud
      os_sdk: openstacksdk
      # Disable public cloud policy limit roles: group keystone_domain keystone_role nova_flavor user user_group
      test_cases: auth image keypair network object port router security_group server subnet volume
    secrets:
      - opentelekomcloud_credentials
    override-checkout: stable-2.7

- job:
    name: openstacksdk-ansible-functional-orange
    parent: init-test
    description: |
      Run openstacksdk ansible functional tests against orange cloud using git stable-2.7 branch version of ansible.
    run: playbooks/ansible-functional-public-clouds/run.yaml
    required-projects:
      - openstack/openstacksdk
    vars:
      cloud_name: orange
      os_sdk: openstacksdk
      # Disable public cloud policy limit roles: group keystone_domain keystone_role nova_flavor user user_group object
      test_cases: auth image keypair network port router security_group server subnet volume
    secrets:
      - orange_credentials
    override-checkout: stable-2.7

- job:
    name: openstacksdk-ansible-functional-telefonica
    parent: init-test
    description: |
      Run openstacksdk ansible functional tests against telefonica cloud using git stable-2.7 branch version of ansible.
    run: playbooks/ansible-functional-public-clouds/run.yaml
    required-projects:
      - openstack/openstacksdk
    vars:
      cloud_name: telefonica
      os_sdk: openstacksdk
      # Disable public cloud policy limit roles: group keystone_domain keystone_role nova_flavor user user_group object
      test_cases: auth image keypair network port router security_group server subnet volume
    secrets:
      - telefonica_credentials
    override-checkout: stable-2.7

- job:
    name: openstacksdk-ansible-functional-huaweicloud
    parent: init-test
    description: |
      Run openstacksdk ansible functional tests against huaweicloud using git stable-2.7 branch version of ansible.
    run: playbooks/ansible-functional-public-clouds/run.yaml
    required-projects:
      - openstack/openstacksdk
    vars:
      cloud_name: huaweicloud
      os_sdk: openstacksdk
      # Disable public cloud policy limit roles: group keystone_domain keystone_role nova_flavor user user_group object
      test_cases: auth image keypair network port router security_group server subnet volume
    secrets:
      - huaweicloud_credentials
    override-checkout: stable-2.7

# packer jobs
- job:
    name: packer-functional-opentelekomcloud
    parent: init-test
    description: |
      Test image building functionality of Packer of v1.3.3 against opentelekomcloud.
    run: playbooks/packer-functional-public-clouds/run.yaml
    vars:
      cloud_name: opentelekomcloud
    secrets:
      - opentelekomcloud_credentials
    override-checkout: v1.3.3

- job:
    name: packer-functional-orange
    parent: init-test
    description: |
      Test image building functionality of Packer of v1.3.3 against orange.
    run: playbooks/packer-functional-public-clouds/run.yaml
    vars:
      cloud_name: orange
    secrets:
      - orange_credentials
    override-checkout: v1.3.3

- job:
    name: packer-functional-telefonica
    parent: init-test
    description: |
      Test image building functionality of Packer of v1.3.3 against telefonica.
    run: playbooks/packer-functional-public-clouds/run.yaml
    vars:
      cloud_name: telefonica
    secrets:
      - telefonica_credentials
    override-checkout: v1.3.3

- job:
    name: packer-functional-huaweicloud
    parent: init-test
    description: |
      Test image building functionality of Packer of v1.3.3 against huaweicloud.
    run: playbooks/packer-functional-public-clouds/run.yaml
    vars:
      cloud_name: huaweicloud
    secrets:
      - huaweicloud_credentials
    override-checkout: v1.3.3

- job:
    name: packer-master-functional-devstack
    parent: init-test
    description: |
      Test image building functionality of Packer of master against devstack.
    run: playbooks/packer-functional-devstack/run.yaml

- job:
    name: packer-functional-devstack
    parent: init-test
    description: |
      Test image building functionality of Packer of v1.3.3 against master devstack.
    run: playbooks/packer-functional-devstack/run.yaml
    override-checkout: v1.3.3

- job:
    name: packer-functional-devstack-rocky
    parent: init-test
    description: |
      Test image building functionality of Packer of v1.3.3 against rocky devstack.
    run: playbooks/packer-functional-devstack/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/rocky
    override-checkout: v1.3.3

- job:
    name: packer-functional-devstack-queens
    parent: init-test
    description: |
      Test image building functionality of Packer of v1.3.3 against queens devstack.
    run: playbooks/packer-functional-devstack/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/queens
    override-checkout: v1.3.3

- job:
    name: packer-functional-devstack-pike
    parent: init-test
    description: |
      Test image building functionality of Packer of v1.3.3 against pike devstack.
    run: playbooks/packer-functional-devstack/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/pike
    override-checkout: v1.3.3

- job:
    name: packer-functional-devstack-ocata
    parent: init-test
    description: |
      Test image building functionality of Packer of v1.3.3 against ocata devstack.
    run: playbooks/packer-functional-devstack/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/ocata
    override-checkout: v1.3.3

- job:
    name: packer-functional-devstack-newton
    parent: init-test
    description: |
      Test image building functionality of Packer of v1.3.3  against newton devstack.
    run: playbooks/packer-functional-devstack/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/newton
    override-checkout: v1.3.3

- job:
    name: packer-functional-devstack-mitaka
    parent: init-test
    description: |
      Test image building functionality of Packer of v1.3.3 against mitaka devstack.
    run: playbooks/packer-functional-devstack/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/mitaka
    override-checkout: v1.3.3
    nodeset: ubuntu-trusty

# docker machine jobs
- job:
    name: docker-machine-functional-opentelekomcloud
    parent: init-test
    description: |
      Test functionalities of Docker machine of v0.16.1 version against opentelekomcloud.
    run: playbooks/docker-machine-functional-public-clouds/run.yaml
    vars:
      cloud_name: opentelekomcloud
    override-checkout: v0.16.1
    secrets:
      - opentelekomcloud_credentials

- job:
    name: docker-machine-functional-orange
    parent: init-test
    description: |
      Test functionalities of Docker machine of v0.16.1 version against orange.
    run: playbooks/docker-machine-functional-public-clouds/run.yaml
    vars:
      cloud_name: orange
    override-checkout: v0.16.1
    secrets:
      - orange_credentials

- job:
    name: docker-machine-functional-telefonica
    parent: init-test
    description: |
      Test functionalities of Docker machine of v0.16.1 version against telefonica.
    run: playbooks/docker-machine-functional-public-clouds/run.yaml
    vars:
      cloud_name: telefonica
      ssh_user: linux
    override-checkout: v0.16.1
    secrets:
      - telefonica_credentials

- job:
    name: docker-machine-functional-huaweicloud
    parent: init-test
    description: |
      Test functionalities of Docker machine of v0.16.1 version against huaweicloud.
    run: playbooks/docker-machine-functional-public-clouds/run.yaml
    vars:
      cloud_name: huaweicloud
    override-checkout: v0.16.1
    secrets:
      - huaweicloud_credentials

- job:
    name: docker-machine-functional-devstack-mitaka
    parent: init-test
    description: |
      Test image building functionality of Docker machine of v0.16.1 version against
      devstack of Mitaka.
    run: playbooks/docker-machine-functional-devstack/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/mitaka
    override-checkout: v0.16.1
    nodeset: ubuntu-trusty

- job:
    name: docker-machine-functional-devstack-newton
    parent: init-test
    description: |
      Test image building functionality of Docker machine of v0.16.1 version against
      devstack of Newton.
    run: playbooks/docker-machine-functional-devstack/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/newton
    override-checkout: v0.16.1

- job:
    name: docker-machine-functional-devstack-ocata
    parent: init-test
    description: |
      Test image building functionality of Docker machine of v0.16.1 version against
      devstack of Ocata.
    run: playbooks/docker-machine-functional-devstack/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/ocata
    override-checkout: v0.16.1

- job:
    name: docker-machine-functional-devstack-pike
    parent: init-test
    description: |
      Test image building functionality of Docker machine of v0.16.1 version against
      devstack of Pike.
    run: playbooks/docker-machine-functional-devstack/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/pike
    override-checkout: v0.16.1

- job:
    name: docker-machine-functional-devstack-queens
    parent: init-test
    description: |
      Test image building functionality of Docker machine of v0.16.1 version against
      devstack of Queens.
    run: playbooks/docker-machine-functional-devstack/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/queens
    override-checkout: v0.16.1

- job:
    name: docker-machine-functional-devstack-rocky
    parent: init-test
    description: |
      Test image building functionality of Docker machine of v0.16.1 version against
      devstack of Rocky.
    run: playbooks/docker-machine-functional-devstack/run.yaml
    vars:
      global_env:
        OS_BRANCH: stable/rocky
    override-checkout: v0.16.1
#
#- job:
#    name: bosh-huaweicloud-cpi-release-acceptance-test
#    parent: init-test
#    description: |
#      This job validation tests of bosh-huaweicloud-cpi-release aganist Huaweicloud
#    run: playbooks/bosh-huaweicloud-cpi-release-acceptance-test/run.yaml
#    required-projects:
#      - zhongjun2/cf-huaweicloud-validator
#    secrets:
#      - huaweicloud_credentials
#    nodeset: ubuntu-xenial-huaweicloud

- job:
    name: bosh-acceptance-test-huaweicloud
    parent: init-test
    description: |
      This job run tests of bosh-acceptance-test aganist Huaweicloud
    run: playbooks/bosh-acceptance-test-huaweicloud/run.yaml
    post-run: playbooks/bosh-acceptance-test-huaweicloud/post.yaml
    required-projects:
      - liu-sheng/bosh-acceptance-tests
    secrets:
      - huaweicloud_credentials
    nodeset: ubuntu-xenial-huaweicloud

- job:
    name: osb-checker-test-huaweicloud
    parent: init-test
    description: |
      This job run tests of osb-checker aganist Huaweicloud
    run: playbooks/osb-checker-test-huaweicloud/run.yaml
    required-projects:
      - openservicebrokerapi/osb-checker
    secrets:
      - huaweicloud_credentials

- job:
    name: manageiq-providers-openstack-test-devstack
    parent: init-test
    description: |
      This job run tests of manageiq-providers-openstack aganist Devstack
    run: playbooks/manageiq-providers-openstack-test-devstack/run.yaml


# terraform-provider-huaweicloud acceptance tests against FusionCloud
- job:
    name: terraform-provider-huaweicloud-v1.2.0-acceptance-test-fusioncloud
    parent: golang-test
    description: |
      Run acceptance tests of terraform-provider-huaweicloud repo against fusioncloud
    run: playbooks/terraform-provider-huaweicloud-acceptance-test-fusioncloud/run.yaml
    post-run: playbooks/terraform-provider-huaweicloud-acceptance-test-fusioncloud/post.yaml
    timeout: 14400
    secrets:
      - fusioncloud_credentials
    override-checkout: v1.2.0

# terraform-provider-openstack acceptance tests against FusionCloud
- job:
    name: terraform-provider-openstack-acceptance-test-fusioncloud
    parent: golang-test
    description: |
      Run acceptance tests of terraform-provider-openstack repo against fusioncloud
    run: playbooks/terraform-provider-openstack-acceptance-test-fusioncloud/run.yaml
    secrets:
      - fusioncloud_credentials

# OpenShift-Origin v3.9.0 test against Fusioncloud
- job:
    name: openshift-origin-v3.9.0-functional-test-fusioncloud
    parent: init-test
    description: |
      Run functional tests of openshift-origin repo of v3.9.0 release against fusioncloud
    run: playbooks/openshift-orgin-functional-test-fusioncloud/run.yaml
    post-run: playbooks/openshift-orgin-functional-test-fusioncloud/post.yaml
    required-projects:
      - huaweicloud/openshift-ansible
    vars:
      cloud_name: fusioncloud
      inventory_name: fusioncloud
      openshift_external_net_name: eip_external_net2
    secrets:
      - fusioncloud_credentials

- job:
    name: openshift-origin-v3.9.0-functional-test-huaweicloud
    parent: init-test
    description: |
      Run functional tests of openshift-origin repo of v3.9.0 release against huaweicloud
    run: playbooks/openshift-orgin-functional-test-public-clouds/run.yaml
    post-run: playbooks/openshift-orgin-functional-test-public-clouds/post.yaml
    required-projects:
      - huaweicloud/openshift-ansible
    vars:
      cloud_name: huaweicloud
      inventory_name: huawei
      openshift_image_name: "CentOS 7.5 64bit"
    secrets:
      - huaweicloud_credentials

- job:
    name: openshift-origin-v3.9.0-functional-test-opentelekomcloud
    parent: init-test
    description: |
      Run functional tests of openshift-origin repo of v3.9.0 release against opentelekomcloud
    run: playbooks/openshift-orgin-functional-test-public-clouds/run.yaml
    post-run: playbooks/openshift-orgin-functional-test-public-clouds/post.yaml
    required-projects:
      - huaweicloud/openshift-ansible
    vars:
      cloud_name: opentelekomcloud
      inventory_name: otc
    secrets:
      - opentelekomcloud_credentials

- job:
    name: openshift-origin-v3.9.0-functional-test-telefonica
    parent: init-test
    description: |
      Run functional tests of openshift-origin repo of v3.9.0 release against telefonica cloud
    run: playbooks/openshift-orgin-functional-test-public-clouds/run.yaml
    post-run: playbooks/openshift-orgin-functional-test-public-clouds/post.yaml
    required-projects:
      - huaweicloud/openshift-ansible
    vars:
      cloud_name: telefonica
      inventory_name: telefonica
    secrets:
      - telefonica_credentials

- job:
    name: openshift-origin-v3.9.0-functional-test-orange
    parent: init-test
    description: |
      Run functional tests of openshift-origin repo of v3.9.0 release against orange cloud
    run: playbooks/openshift-orgin-functional-test-public-clouds/run.yaml
    post-run: playbooks/openshift-orgin-functional-test-public-clouds/post.yaml
    required-projects:
      - huaweicloud/openshift-ansible
    vars:
      cloud_name: orange
      inventory_name: orange
    secrets:
      - orange_credentials

- job:
    name: ai-on-openlab-test-tensorflow-k8s
    parent: init-test
    description: |
      Test tensorflow in openlab k8s cluster.
    run: playbooks/ai-on-openlab-tensorflow-k8s/run.yaml

- job:
    name: ai-on-openlab-test-vm
    parent: init-test
    description: |
      Train and inference AI model in openlab VM.
    pre-run: playbooks/ai-on-openlab/pre.yaml
    run: playbooks/ai-on-openlab/run.yaml
    post-run: playbooks/ai-on-openlab/post.yaml
    nodeset: ubuntu-xenial
    vars:
      is_gpu_enabled: false

- job:
    name: ai-on-openlab-test-vm-with-gpu
    parent: init-test
    description: |
      Train and inference AI model on GPU in openlab VM.
    pre-run: playbooks/ai-on-openlab/pre.yaml
    run: playbooks/ai-on-openlab/run.yaml
    post-run: playbooks/ai-on-openlab/post.yaml
    nodeset: ubuntu-xenial-gpu
    vars:
      is_gpu_enabled: true

- job:
    name: arm-on-openlab-test
    parent: init-test
    description: |
      Test arm in openlab cluster.
    run: playbooks/arm-on-openlab/run.yaml
    nodeset: ubuntu-xenial-arm64


- job:
    name: spark-integration-test-kubeadm-k8s
    parent: init-test
    description: |
      Run integration tests of spark of master with k8s cluster deployed by kubeadm
    run: playbooks/spark-integration-test-kubeadm-k8s/run.yaml

- job:
    name: spark-integration-test-minikube-k8s
    parent: init-test
    description: |
      Run integration tests of spark of v2.4.0 with k8s cluster deployed by minikube
    run: playbooks/spark-integration-test-minikube-k8s/run.yaml
    override-checkout: branch-2.4
